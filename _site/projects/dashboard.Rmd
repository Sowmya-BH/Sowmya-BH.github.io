<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by Youssef Raafat
  Free for personal and commercial use under the MIT license
  https://github.com/YoussefRaafatNasry/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="R Notebook">
  <meta property="og:description" content="I am definitely not a corgi!">
  <meta property="og:image" content="https://dogtime.com/assets/uploads/gallery/pembroke-welsh-corgi-dog-breed-pictures/prance-8.jpg">

  <title>R Notebook</title>
  <meta name="description" content="I am definitely not a corgi!">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Sowmya Bhupatiraju</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link active" href="/projects/">Projects</a>

      <a class="nav-item nav-link " href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.



library(FactoMineR) #Dataset and HCPC
library(Hmisc) #Describe Function
library(psych) #Multiple Functions for Statistics and Multivariate Analysis
library(GGally) #ggpairs Function
library(ggplot2) #ggplot2 Functions
library(vioplot) #Violin Plot Function
library(corrplot) #Plot Correlations
library(REdaS) #Bartlett's Test of Sphericity
library(psych) #PCA/FA functions
library(factoextra) #PCA Visualizations
library("FactoMineR") #PCA functions / Hierarchical Clustering
library(ade4) #PCA Visualizations
library(cluster) #Basic Clustering Algorithms
library(fpc) #DBSCAN
library(dbscan) #DBSCAN
library(mclust) #Model Clustering
library(kernlab) #Spectral Clustering


#Set Working Directory
setwd('/Users/bhupatiraju/Downloads')

#Read in Dataset
bsket <- read.csv(file="CollegeBasketballPlayers2009-2021.csv", header=TRUE)
bsket
 
basket = bsket[bsket$Min_per > 28.7, ]

# No of unique values
unique(basket$player_name)
unique(basket$team)
unique(basket$conf)


#Check Sample Size and Number of Variables
dim(basket)
names(basket)


#Check for Missing Values (i.e. NAs)

#For All Variables
#subsetting data

#Check for missing values for All Variables
sum(is.na(basket))
basket2 <- na.omit(basket)

sum(is.na(basket2))

basket2

basket2b <-basket[,c(8:20, 23, 26, 28, 30:33, 36, 39:41, 45, 49:53,55)]

# Selecting columns
basket1 <- basket[,c(4:25,29:32,46 )]

#Listwise Deletion
basket1 <- na.omit(basket1)
basket1 

#Check new data has no missing data
sum(is.na(basket1))
dim(basket1)


#Check dimensions and column names of new data 
dim(basket1)
names(basket1)


# Let's first scale the data:
# Normalizing the Data
basket_scale <- scale(basket1) 

library(cluster)
library(factoextra)

basket_scale <- scale(basket1) 

#Determining Optimal Number of Clusters
fviz_nbclust(basket_scale, kmeans)


#Run K-Means Cluster Analysis
set.seed(123)
basket_k <- kmeans(basket_scale, centers=2, iter.max=123, nstart = 15)
basket_k


# Cluster size
basket_k$size
# end up in 3 clusters of sizes - 391 668 376
#model explains 30.3% of the model

# Cluster means
basket_k$centers
#

# Visualize
# Note with the large dataset it will take a long time, but is good for small sample size ~1,000 samples
library("factoextra")
fviz_cluster(basket_k, data = basket_scale, 
             ellipse.type = "convex",
             palette = "jco",
             repel = TRUE,
             ggtheme = theme_minimal())


#Another Way to Choose Optimal Clusters

#Enter name of the data matrix to be clustered here:
my.data.matrix <- basket_scale


my.k.choices <- 2:6
n <- length(my.data.matrix[,1])
wss1 <- (n-1)*sum(apply(my.data.matrix,2,var))
wss <- numeric(0)
for(i in my.k.choices) {
  W <- sum(kmeans(my.data.matrix,i)$withinss)
  wss <- c(wss,W)
}
wss <- c(wss1,wss)
plot(c(1,my.k.choices),wss,type='l',xlab='Number of clusters', ylab='Within-groups sum-of-squares', lwd=2)



#Run K-Means Cluster Analysis for 4 Clusters
set.seed(123)
basket_k4 <- kmeans(basket_scale, centers=6, iter.max=100, nstart = 25)
basket_k4

# Visualize
library("factoextra")
fviz_cluster(basket_k4, data = basket_scale, 
             ellipse.type = "convex",
             palette = "jco",
             repel = TRUE,
             ggtheme = theme_minimal())

# Cluster size
basket_k4$size

# Cluster means
basket_k4$centers




#Run K-Means Cluster Analysis for 4 Clusters
set.seed(123)
basket_k2 <- kmeans(basket_scale, centers=2, iter.max=100, nstart = 25)
basket_k2

# Visualize
library("factoextra")
fviz_cluster(basket_k2, data = basket_scale, 
             ellipse.type = "convex",
             palette = "jco",
             repel = TRUE,
             ggtheme = theme_minimal())

# Cluster size
basket_k2$size

# Cluster means
basket_k2$centers

#Aggregating the Clusters
basket_k4_clust <- lapply(1:4, function(nc) row.names(basket_scale)[basket_k4$cluster==nc])  
basket_k4_clust 


#Alternative Way of Running K-Means Clustering

library("factoextra")
# K-means clustering
basket_kmeans4 <- eclust(basket_scale, "kmeans", k = 6,
                            nstart = 15, graph = FALSE)
basket_kmeans4


# Visualize the silhouette of clusters
fviz_silhouette(basket_kmeans4)







</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>A. P. Corgi</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:username@domain.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.github.com/jnaiman"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.twitter.com/your_username"
       style="color: #6c757d"
       onMouseOver="this.style.color='#1da1f2'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-twitter fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.youtube.com/your_channel_name"
       style="color: #6c757d"
       onMouseOver="this.style.color='#ff0000'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-youtube fa-1x"></i>
    </a>

</div><small id="attribution">
    theme <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small>

</footer>




  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>